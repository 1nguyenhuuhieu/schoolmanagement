
          {% extends 'base_withsidebar.html' %}
          {% load static %}
          {% block content %}
          {% load lessonmanagement_extras %}
          {% with teacher=request.user.teacher %}
          <div class="bg-white border shadow-sm p-3 rounded-pill mb-4">
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb m-0 ">
                <li class="breadcrumb-item"><a href="{% url 'index' %}" class="text-decoration-none"><i class="fas fa-home me-2"></i>Trang chủ</a></li>
                <li class="breadcrumb-item"> <a href="{% url 'alllessons' %}" class="text-decoration-none">Giáo án</a></li>
                <li class="breadcrumb-item active" aria-current="page">Thống kê</li>
              </ol>
            </nav>
          </div>
          <h5 class="mb-4"><i class="fas fa-chart-bar fa-fw me-2"></i>Thống Kê Giáo Án Của Tôi</h5>
          <div class="card mb-5 rounded-15 shadow-sm" >
            <div class="row g-0">
              <div class="col-md-5">
                <img src="{% static 'imgs/welcome.png' %}"  class="img-fluid" alt="...">
              </div>
              <div class="col">
                <div class="card-body">
                  <h5 class="card-title">Xin chào</h5>
                  <div class="d-flex align-items-center"> <h4 class="me-2" ><a href="#" class="text-decoration-none">{{ teacher.full_name }} </a></h4><span class="text-muted"> {{ teacher.get_education_level_display }} <a href="#" class="text-decoration-none">{{ teacher.main_subject }}</a>.</span></div>
                  <h6 class="text-muted">  {% if teacher.managers.school %}{{ teacher.managers.school.get_role_display }} <a href="#" class="text-decoration-none"> {{ teacher.managers.school.school.title }}</a>.{% endif %}</h6>
                  <p class="card-text">
                    <ul class="list-unstyled text-muted">
                      <li>  <i class="fas fa-user-friends  fa-fw me-2 text-muted"></i>{{ teacher.managers.subject.get_role_display }}<a href="#" class="text-decoration-none"> Tổ {{ teacher.managers.subject.subject.title }}</a>. {% if teacher.managers.group%}{{ teacher.managers.group.get_role_display }} <a href="#" class="text-decoration-none">Bộ môn {{ teacher.managers.group.group.title }}</a>.{% endif %}</li>
                      {% if teacher.managers.class %} <li><i class="fas fa-users fa-fw me-2 text-muted"></i>Chủ nhiệm lớp <a href="#" class="text-decoration-none"> {{ teacher.managers.class }}</a>. </li>{% endif %}
                    </ul>
                </p>  
                  <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
                </div>
              </div>
            </div>
          </div>
              <h6 class="mb-3  ">Giáo án vừa thêm</h6>
                {% for i in request.user.teacher.latest_lesson %}
                <div class="card mb-4 rounded-15 shadow-sm">
                  <div class="row g-0">
                    <div class="col-1 p-2 d-flex align-items-center">
                      <img src="{% static 'imgs/math.jpeg' %}"  class="img-fluid rounded-circle" alt="">
                    </div>
                    <div class="col-11">
                      <div class="card-body">
                        <h6 class="card-title">
                          <a href="{% url 'lesson' i.id %}" class="text-reset text-decoration-none">  {{ i.title }}</a>
                        </h6>
                        <span class="text-dark fw-bold">
                        <a href="#" class="text-decoration-none"> {{ i.subject.title }}</a>{% if i.display_classyear %}({% for j in i.display_classyear %}{{j}}{%if forloop.last %}{% else %},{% endif %}{% endfor %}) {% endif %} / Tiết {{ i.start_number_lesson}} {% if i.cout_number_lesson > 1 %} - {{ i.start_number_lesson|add:i.cout_number_lesson }} {% endif %}
                      </span>
                      <small class="text-muted">cách đây
    {{ i.upload_time|timesince}} vào lúc {{ i.upload_time }}</small>
                        <hr class="my-2">
                        {% if i.status == "pending" %}
                        <span class="badge bg-warning text-dark rounded-pill" style="width: 105px;"><i class="far fa-clock me-1"></i>Chờ duyệt</span>
                        {% elif i.status == "acept" %}
                        <span class="badge bg-success  rounded-pill" style="width: 105px;"><i class="fas fa-check me-1"></i>Đã duyệt</span> <small class="text-muted">bởi<a href="#" class="text-decoration-none"> {{ i.checker.full_name }}</a> 
                          cách đây
                          {{ i.upload_time|timesince}} vào lúc {{ i.check_date }}</small>  
                         {% elif i.status == "deny" %}
                         <span class="badge bg-danger  rounded-pill" style="width: 105px;"><i class="fas fa-times me-1"></i>Bị từ chối</span> <small class="text-muted">bởi<a href="#" class="text-decoration-none"> {{ i.checker.full_name }}</a> 
                          cách đây
    {{ i.upload_time|timesince}} vào lúc {{ i.check_date }}</small> 
                        {% endif %} 
                      </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
                <a href="{% url 'alllessons' %}" class="text-decoration-none"> Xem tất cả giáo án <i class="fas fa-arrow-right ms-2 text-muted"></i> </a>
          <hr class="mb-4"> 
          <div class="row">
            <h6 class="mb-3">Thống kê Giáo Án</h6>
            <div class="col">
                <div class="card  rounded-15 shadow-sm mb-3 text-center">
                  <div class="card-body">
                    <h1 class="card-title link-success fw-bold display-4">{{ teacher.count_lesson.total }}</h1>
                    <p class="card-text text-muted fs-5" >
                      <a href="{% url 'alllessons' %}" class="stretched-link text-decoration-none">Tổng số đã tải lên</a>
                    </p>
                  </div>
                </div>
          </div>
            <div class="col">
              <a href="{% url 'alllessons' %}" class="text-decoration-none">
              <div class="card rounded-15 shadow-sm mb-3  text-center">
                <div class="card-body">
                 <h1 class="card-title link-primary fw-bold display-4">{{ teacher.count_lesson.year }}</h1>
                 <p class="card-text text-muted fs-5" >
                 <a href="{% url 'alllessons' %}" class="stretched-link text-decoration-none">Tải lên năm {{ teacher.schoolyear }}</a>
                 </p>
                </div>
              </div>
              </a>
            </div>
            <div class="col">
              <a href="{% url 'alllessons' %}" class="text-decoration-none">
              <div class="card rounded-15 shadow-sm mb-3  text-center">
                <div class="card-body">
                 <h1 class="card-title link-info fw-bold display-4">{{ teacher.count_lesson.month }}</h1>
                 <p class="card-text text-muted fs-5" >
                 <a href="{% url 'alllessons' %}" class="stretched-link text-decoration-none">Tải lên trong {% now "M" %}</a>
                 </p>
                </div>
              </div>
              </a>
            </div>
          </div>
          <hr class="mb-4">
          <h6 class="mb-3">Thời lượng giảng dạy</h6>
          {% for i in subject_classyear %}
          <div class="row 
          {% if not forloop.last %}
          border-bottom
          {% endif %}
           py-3">
            <div class="col-4">
              <h6 class="m-0"> <a href="#" class="text-decoration-none">{{i.subject.title}} {{ i.classyear }}</a>  <small class="text-muted">Tiết {{ i.current_lesson }}/{{ i.total_lesson }}</small> </h6>
            </div>
            <div class="col">
          <div class="progress">
            <div class="progress-bar bg-success" role="progressbar" style="width: {% widthratio i.current_lesson i.total_lesson 100 %}%;" aria-valuenow="{% widthratio i.current_lesson i.total_lesson 100 %}" aria-valuemin="0" aria-valuemax="100">{% widthratio i.current_lesson i.total_lesson 100 %}%</div>
          </div>
            </div>
          </div>
          {% endfor %}
          {% endwith %}
           {% endblock %}